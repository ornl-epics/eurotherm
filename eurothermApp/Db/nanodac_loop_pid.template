
#############################################################
#
# Database template to read and write loop PID variables 
# for the eurotherm nanodac. The PID set parameters
# are dealt with in a seperate template, instantiated in
# this one.
# 
# S - base PV name
# L - loop number
# PORT - asyn port name for loop PID data
#
# Note: By convention the port name for the writeable parameters
# is the same as the read parameters, but with a 'w' on the end.
# 
############################################################

############################################################
# Read records
############################################################

record(mbbi, "$(S):SE:Loop$(L):PID:Type")
{
  field(DESC, "Loop$(L) PID Type")
  field(DTYP, "asynInt32")
  field(INP, "@asyn($(PORT),0,1)")
  field(SCAN, "I/O Intr")
  field(ZRVL, "0")
  field(ONVL, "1")
  field(TWVL, "2")
  field(THVL, "3")
  field(FRVL, "4")
  field(FVVL, "5")
  field(SXVL, "6")
  field(ZRST, "Off")
  field(ONST, "Set")
  field(TWST, "Setpoint")
  field(THST, "PV")
  field(FRST, "Error")
  field(FVST, "Output")
  field(SXST, "Remote")
}

record(ai, "$(S):SE:Loop$(L):PID:NumSets")
{
  field(DESC, "Loop$(L) Output Num Sets")
  field(DTYP, "asynInt32")
  field(INP, "@asyn($(PORT),1,1)")
  field(SCAN, "I/O Intr")
}

record(ai, "$(S):SE:Loop$(L):PID:PB1")
{
  field(DESC, "Loop$(L) PB1")
  field(DTYP, "asynInt32")
  field(INP, "@asyn($(PORT),6,1)")
  field(SCAN, "I/O Intr")
  field(LINR, "LINEAR")
  field(ESLO, "0.1")
  field(PREC, "1")
}

############################################################
# Write records
############################################################

record(mbbo, "$(S):SE:Loop$(L):PID:TypeSet")
{
  field(DESC, "Set Loop$(L) PID Type")
  field(DTYP, "asynInt32")
  field(OUT, "@asyn($(PORT)w,0,1)")
  field(ZRVL, "0")
  field(ONVL, "1")
  field(TWVL, "2")
  field(THVL, "3")
  field(FRVL, "4")
  field(FVVL, "5")
  field(SXVL, "6")
  field(ZRST, "Off")
  field(ONST, "Set")
  field(TWST, "Setpoint")
  field(THST, "PV")
  field(FRST, "Error")
  field(FVST, "Output")
  field(SXST, "Remote")  
}

record(ao, "$(S):SE:Loop$(L):PID:NumSetsSet")
{
  field(DESC, "Set Loop$(L) Output Num Sets")
  field(DTYP, "asynInt32")
  field(OUT, "@asyn($(PORT)w,1,1)")
}

record(ao, "$(S):SE:Loop$(L):PID:PB1Set")
{
  field(DESC, "Set Loop$(L) PB1")
  field(DTYP, "asynInt32")
  field(OUT, "@asyn($(PORT)w,6,1)")
  field(LINR, "LINEAR")
  field(ESLO, "0.1")
  field(PREC, "1")
}


